unit Connector;

interface

uses windows;

type
  TGetProcessList = procedure(out processes : WideString); stdcall;
  TOpenProcess = procedure(pid: WideString); stdcall;
  TResetScripts = procedure(); stdcall;
  TAddScript = procedure(name: WideString; script: WideString); stdcall;
  TRemoveScript = procedure(id: integer); stdcall;
  TActivateScript = procedure(id: integer; activate: boolean); stdcall;

  TProcessAddress = procedure(address : WideString ; vartype : TVariableType ; showashexadecimal: Boolean=false;
  showAsSigned: boolean=false; bytesize: Integer = 1; out res_address : WideString = '');stdcall;

var
  IGetProcessList: TGetProcessList;
  IOpenProcess: TOpenProcess;
  IResetScripts: TResetScripts;
  IAddScript: TAddScript;
  IRemoveScript: TRemoveScript;
  IActivateScript: TActivateScript;

procedure loadFunctions(handle: THandle);

implementation

procedure loadFunctions(handle: THandle);
begin
  @IGetProcessList := GetProcAddress(handle, 'IGetProcessList');
  @IOpenProcess := GetProcAddress(handle, 'IOpenProcess');
  @IResetScripts := GetProcAddress(handle, 'IResetScripts');
  @IAddScript := GetProcAddress(handle, 'IAddScript');
  @IRemoveScript := GetProcAddress(handle, 'IRemoveScript');
  @IActivateScript := GetProcAddress(handle, 'IActivateScript');
end;

end.
